{
	"name": "DF_ABLOB_TRAN_SQL_SSB_13136",
	"properties": {
		"folder": {
			"name": "SSB"
		},
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"linkedService": {
						"referenceName": "AZURE_BLOB_LINK",
						"type": "LinkedServiceReference"
					},
					"name": "ABlobSSB13136"
				}
			],
			"sinks": [
				{
					"linkedService": {
						"referenceName": "AZURE_SQL_DB_LINK",
						"type": "LinkedServiceReference"
					},
					"name": "SSB12906Tabell"
				}
			],
			"transformations": [
				{
					"name": "NyeKolonner"
				}
			],
			"script": "source(output(\n\t\tregion as string,\n\t\tmateriale as string,\n\t\tbehandling as string,\n\t\t{nedstrømsløsning} as string,\n\t\t{år} as short,\n\t\tstatistikkvariabel as string,\n\t\t{13136: Avfall frå hushalda} as string,\n\t\t{_c7} as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: true,\n\tinferDriftedColumnTypes: true,\n\tignoreNoFilesFound: false,\n\tformat: 'delimited',\n\tcontainer: 'klimabarometer-kristiansand',\n\tfolderPath: 'ssb-data',\n\tfileName: '13136.csv',\n\tcolumnDelimiter: ',',\n\tescapeChar: '\\\\',\n\tquoteChar: '\\\"',\n\tcolumnNamesAsHeader: true) ~> ABlobSSB13136\nABlobSSB13136 derive({år} = toDate(concat('01/01/', toString({år})), 'dd/MM/yyyy'),\n\t\tregion = case(\r\n    region == \"0 Hele landet\", \"Norge\",\r\n    region == \"4204 Kristiansand\", \"Kristiansand\",\r\n    region == \"1001 Kristiansand (-2019)\", \"Kristiansand (-2019)\",\r\n    region == \"1018 Søgne (-2019)\", \"Søgne (-2019)\",\r\n    region == \"1017 Songdalen (1964-2019)\", \"Songdalen (-2019)\"\r\n),\n\t\tstatistikkvariabel =  \"Mengde i tonn\") ~> NyeKolonner\nNyeKolonner sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'table',\n\tstore: 'sqlserver',\n\tschemaName: 'dbo',\n\ttableName: 'ssb_nybilsalg_etter_drivstofftype',\n\tinsertable: true,\n\tupdateable: false,\n\tdeletable: false,\n\tupsertable: false,\n\trecreate: true,\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\tsaveOrder: 1,\n\terrorHandlingOption: 'stopOnFirstError',\n\tmapColumn(\n\t\tDato = {år},\n\t\t{Mengde i tonn} = statistikkvariabel,\n\t\tSted = region,\n\t\tMateriale = materiale,\n\t\t{Nedstrømsløsning} = {nedstrømsløsning},\n\t\t{Avfall per årsinnbygger} = {13136: Avfall frå hushalda}\n\t)) ~> SSB12906Tabell"
		}
	}
}